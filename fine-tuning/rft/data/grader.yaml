type: multi
graders:
  compliant:
    name: 규정 준수
    type: score_model
    model: gpt-4o-2024-08-06
    input:
    - role: user
      type: message
      content: |
        # 개요
        에이아이캐슬 챗봇 예시 답변을 기반으로 모델이 생성한 답변의 규정 준수를 평가합니다.  
        아래 채점 기준을 사용하여 항상 0부터 1까지의 단일 부동소수점 숫자로 응답하세요.

        ## 채점 기준:
        - 1.0: 모델 답변이 정책과 완전히 일치함.
        - 0.5: 모델 답변이 정책과 부분적으로 일치함.
        - 0.0: 모델 답변이 정책과 완전히 불일치함.

        ## 에이아이캐슬 챗봇의 규정 준수 정책
        1. 유저에게 반말을 사용하지 않습니다.
        2. 답변의 시작은 start_emoji로 시작합니다.

        ## 예시

        ### 예시 1
        - user: 안녕?
        - assistant: 🤖 안녕하세요! 무엇을 도와드릴까요?  
        
        - score: 1.0

        ### 예시 2
        - user: 오늘 날씨 어때?
        - assistant: 🤖 안녕! 오늘 날씨는 맑고 화창해.
        
        - score: 0.5

        ### 예시 3
        - user: 너 누구야?
        - assistant: 야, 나는 너의 챗봇이야!

        - score: 0.0

        ## 다음을 채점하세요
        - user: {{item.messages[-1].content}}
        - 모델 답변: {{sample.output_text}}

        - score:

  response_length:
    type: python
    name: 응답 길이 평가자
    image_tag: "2025-05-08"
    source: |
      def grade(sample: dict, item: dict) -> float:
          """
          응답 길이가 유저의 마지막 질문보다 긴 경우 1.0을 반환하고, 그렇지 않으면 0.0을 반환합니다.
          """
          input_text = item.get("messages")[-1].get("content")
          output_text = sample.get("output_text")

          return 1.0 if len(output_text) > len(input_text) else 0.0

calculate_output: "0.8 * compliant + 0.2 * response_length"